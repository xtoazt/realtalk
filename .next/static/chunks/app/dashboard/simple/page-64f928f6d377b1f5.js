(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1916],{6947:(e,t,r)=>{Promise.resolve().then(r.bind(r,7681))},7328:(e,t,r)=>{"use strict";r.d(t,{D:()=>d,N:()=>u});var o=r(364),n=(e,t,r,o,n,s,a,i)=>{let l=document.documentElement,c=["light","dark"];function d(t){var r;(Array.isArray(e)?e:[e]).forEach(e=>{let r="class"===e,o=r&&s?n.map(e=>s[e]||e):n;r?(l.classList.remove(...o),l.classList.add(s&&s[t]?s[t]:t)):l.setAttribute(e,t)}),r=t,i&&c.includes(r)&&(l.style.colorScheme=r)}if(o)d(o);else try{let e=localStorage.getItem(t)||r,o=a&&"system"===e?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":e;d(o)}catch(e){}},s=["light","dark"],a="(prefers-color-scheme: dark)",i="undefined"==typeof window,l=o.createContext(void 0),c={setTheme:e=>{},themes:[]},d=()=>{var e;return null!=(e=o.useContext(l))?e:c},u=e=>o.useContext(l)?o.createElement(o.Fragment,null,e.children):o.createElement(m,{...e}),h=["light","dark"],m=e=>{let{forcedTheme:t,disableTransitionOnChange:r=!1,enableSystem:n=!0,enableColorScheme:i=!0,storageKey:c="theme",themes:d=h,defaultTheme:u=n?"system":"light",attribute:m="data-theme",value:y,children:v,nonce:b,scriptProps:S}=e,[w,k]=o.useState(()=>f(c,u)),[E,C]=o.useState(()=>"system"===w?x():w),j=y?Object.values(y):d,T=o.useCallback(e=>{let t=e;if(!t)return;"system"===e&&n&&(t=x());let o=y?y[t]:t,a=r?g(b):null,l=document.documentElement,c=e=>{"class"===e?(l.classList.remove(...j),o&&l.classList.add(o)):e.startsWith("data-")&&(o?l.setAttribute(e,o):l.removeAttribute(e))};if(Array.isArray(m)?m.forEach(c):c(m),i){let e=s.includes(u)?u:null,r=s.includes(t)?t:e;l.style.colorScheme=r}null==a||a()},[b]),L=o.useCallback(e=>{let t="function"==typeof e?e(w):e;k(t);try{localStorage.setItem(c,t)}catch(e){}},[w]),A=o.useCallback(e=>{C(x(e)),"system"===w&&n&&!t&&T("system")},[w,t]);o.useEffect(()=>{let e=window.matchMedia(a);return e.addListener(A),A(e),()=>e.removeListener(A)},[A]),o.useEffect(()=>{let e=e=>{e.key===c&&(e.newValue?k(e.newValue):L(u))};return window.addEventListener("storage",e),()=>window.removeEventListener("storage",e)},[L]),o.useEffect(()=>{T(null!=t?t:w)},[t,w]);let P=o.useMemo(()=>({theme:w,setTheme:L,forcedTheme:t,resolvedTheme:"system"===w?E:w,themes:n?[...d,"system"]:d,systemTheme:n?E:void 0}),[w,L,t,E,n,d]);return o.createElement(l.Provider,{value:P},o.createElement(p,{forcedTheme:t,storageKey:c,attribute:m,enableSystem:n,enableColorScheme:i,defaultTheme:u,value:y,themes:d,nonce:b,scriptProps:S}),v)},p=o.memo(e=>{let{forcedTheme:t,storageKey:r,attribute:s,enableSystem:a,enableColorScheme:i,defaultTheme:l,value:c,themes:d,nonce:u,scriptProps:h}=e,m=JSON.stringify([s,r,l,t,d,c,a,i]).slice(1,-1);return o.createElement("script",{...h,suppressHydrationWarning:!0,nonce:"undefined"==typeof window?u:"",dangerouslySetInnerHTML:{__html:"(".concat(n.toString(),")(").concat(m,")")}})}),f=(e,t)=>{let r;if(!i){try{r=localStorage.getItem(e)||void 0}catch(e){}return r||t}},g=e=>{let t=document.createElement("style");return e&&t.setAttribute("nonce",e),t.appendChild(document.createTextNode("*,*::before,*::after{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}")),document.head.appendChild(t),()=>{window.getComputedStyle(document.body),setTimeout(()=>{document.head.removeChild(t)},1)}},x=e=>(e||(e=window.matchMedia(a)),e.matches?"dark":"light")},7616:(e,t,r)=>{"use strict";r.d(t,{J:()=>l,v:()=>i});var o=r(2432),n=r(364),s=r(7328);let a=(0,n.createContext)(void 0);function i(e){let{children:t}=e,[r,i]=(0,n.useState)(null),[l,c]=(0,n.useState)(!0),{setTheme:d,theme:u}=(0,s.D)(),[h,m]=(0,n.useState)(!1);(0,n.useEffect)(()=>{m(!0)},[]);let p=e=>{h&&((null==e?void 0:e.hue)?(console.log("[UserProvider] Applying hue:",e.hue),["hue-blue","hue-purple","hue-pink","hue-red","hue-orange","hue-yellow","hue-green","hue-teal"].forEach(e=>document.documentElement.classList.remove(e)),document.documentElement.classList.add("hue-".concat(e.hue))):(["hue-blue","hue-purple","hue-pink","hue-red","hue-orange","hue-yellow","hue-green","hue-teal"].forEach(e=>document.documentElement.classList.remove(e)),document.documentElement.classList.add("hue-blue")))};return(0,n.useEffect)(()=>{let e=async()=>{try{console.log("[UserProvider] Fetching user data...");let e=await fetch("/api/auth/me",{cache:"no-store"});if(e.ok){let t=await e.json();if(console.log("[UserProvider] User data received:",t.user),i(t.user),h&&t.user){try{d(t.user.theme||"light")}catch(e){}p(t.user)}}else console.log("[UserProvider] No user found"),i(null)}catch(e){console.error("[UserProvider] Fetch error:",e),i(null)}finally{c(!1)}};h&&(e(),setTimeout(()=>{},0))},[h,d]),(0,n.useEffect)(()=>{h&&p(r)},[r,h]),(0,o.jsx)(a.Provider,{value:{user:r,loading:l,setUser:e=>{console.log("[UserProvider] updateUser called with:",e),i(e),h&&e&&(d(e.theme||"light"),p(e))}},children:t})}function l(){let e=(0,n.useContext)(a);if(void 0===e)throw Error("useUser must be used within a UserProvider");return e}},7681:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>i});var o=r(2432),n=r(364),s=r(9262),a=r(7616);function i(){let{user:e,loading:t}=(0,a.J)(),r=(0,s.useRouter)(),[i,l]=(0,n.useState)([]),[c,d]=(0,n.useState)(""),[u,h]=(0,n.useState)(!1),[m,p]=(0,n.useState)("chat");(0,n.useEffect)(()=>{if(!t&&!e){r.push("/auth");return}if(e){f();let e=setInterval(f,3e3);return()=>clearInterval(e)}},[e,t,r,m]);let f=async()=>{try{let e="ai"===m?"ai-user-id-12345":void 0,t=new URLSearchParams({chatType:"ai"===m?"dm":"global"});e&&t.append("chatId",e);let r=await fetch("/api/messages?".concat(t));if(r.ok){let e=await r.json();l(e.messages.slice(-20))}}catch(e){console.error("Failed to fetch messages:",e)}},g=async e=>{if(e.preventDefault(),c.trim()&&!u){h(!0);try{let e="ai"===m?"dm":"global",t="ai"===m?"ai-user-id-12345":void 0;(await fetch("/api/messages",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:c.trim(),chatType:e,chatId:t})})).ok&&(d(""),f())}catch(e){console.error("Failed to send message:",e)}finally{h(!1)}}},x=async()=>{try{await fetch("/api/auth/signout",{method:"POST"}),r.push("/auth")}catch(e){r.push("/auth")}},y=e=>{localStorage.setItem("ui-mode",e),r.push("/dashboard".concat("full"===e?"":"/".concat(e)))};return t?(0,o.jsx)("div",{style:{padding:"20px",fontFamily:"monospace"},children:"Loading..."}):e?(0,o.jsxs)("div",{style:{fontFamily:"monospace",backgroundColor:"#ffffff",color:"#000000",minHeight:"100vh",padding:"10px"},children:[(0,o.jsxs)("div",{style:{borderBottom:"1px solid #cccccc",paddingBottom:"10px",marginBottom:"10px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("strong",{children:"real.simple"}),(0,o.jsxs)("span",{style:{marginLeft:"10px",color:"#666"},children:["@",e.username]}),(0,o.jsxs)("span",{style:{marginLeft:"10px",fontSize:"10px",color:"#999"},children:["[","chat"===m?"GLOBAL CHAT":"AI CHAT","]"]})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("button",{onClick:()=>p("chat"===m?"ai":"chat"),style:{marginRight:"5px",padding:"2px 8px",border:"1px solid #000",background:"ai"===m?"#000":"white",color:"ai"===m?"white":"#000",cursor:"pointer",fontSize:"10px"},children:"chat"===m?"AI":"CHAT"}),(0,o.jsx)("button",{onClick:()=>y("lite"),style:{marginRight:"5px",padding:"2px 8px",border:"1px solid #ccc",background:"white",cursor:"pointer",fontSize:"10px"},children:"LITE"}),(0,o.jsx)("button",{onClick:()=>y("full"),style:{marginRight:"5px",padding:"2px 8px",border:"1px solid #ccc",background:"white",cursor:"pointer",fontSize:"10px"},children:"FULL"}),(0,o.jsx)("button",{onClick:()=>r.push("/settings/simple"),style:{marginRight:"5px",padding:"2px 8px",border:"1px solid #ccc",background:"white",cursor:"pointer",fontSize:"10px"},children:"SET"}),(0,o.jsx)("button",{onClick:x,style:{padding:"2px 8px",border:"1px solid #ccc",background:"white",cursor:"pointer",fontSize:"10px"},children:"OUT"})]})]}),(0,o.jsx)("div",{style:{height:"calc(100vh - 120px)",overflow:"auto",border:"1px solid #cccccc",padding:"10px",marginBottom:"10px",backgroundColor:"#fafafa"},children:0===i.length?(0,o.jsx)("div",{style:{textAlign:"center",color:"#999",padding:"20px"},children:"No messages yet"}):i.map(e=>(0,o.jsxs)("div",{style:{marginBottom:"6px",lineHeight:"1.2"},children:[(0,o.jsxs)("span",{style:{fontSize:"10px",fontWeight:"bold"},children:[e.username,":"]})," ",(0,o.jsx)("span",{style:{fontSize:"10px"},children:e.content}),(0,o.jsx)("div",{style:{fontSize:"8px",color:"#999",marginTop:"1px"},children:new Date(e.created_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]},e.id))}),(0,o.jsx)("form",{onSubmit:g,children:(0,o.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[(0,o.jsx)("input",{type:"text",value:c,onChange:e=>d(e.target.value),placeholder:"ai"===m?"Ask AI...":"Type message...",style:{flex:1,padding:"8px",border:"1px solid #cccccc",fontSize:"11px",fontFamily:"monospace"},disabled:u}),(0,o.jsx)("button",{type:"submit",disabled:u||!c.trim(),style:{padding:"8px 16px",border:"1px solid #cccccc",backgroundColor:u?"#f0f0f0":"#ffffff",cursor:u?"not-allowed":"pointer",fontSize:"12px",fontFamily:"monospace"},children:u?"SEND...":"SEND"})]})})]}):null}},9262:(e,t,r)=>{"use strict";var o=r(6834);r.o(o,"useRouter")&&r.d(t,{useRouter:function(){return o.useRouter}})}},e=>{var t=t=>e(e.s=t);e.O(0,[5022,5575,7358],()=>t(6947)),_N_E=e.O()}]);