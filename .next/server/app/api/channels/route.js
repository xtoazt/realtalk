"use strict";(()=>{var e={};e.id=4078,e.ids=[4078],e.modules={3295:e=>{e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10762:e=>{e.exports=import("@neondatabase/serverless")},10846:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},29294:e=>{e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},32898:(e,t,r)=>{r.a(e,async(e,s)=>{try{r.r(t),r.d(t,{patchFetch:()=>u,routeModule:()=>c,serverHooks:()=>h,workAsyncStorage:()=>l,workUnitAsyncStorage:()=>d});var n=r(36044),a=r(63409),o=r(9576),i=r(44443),p=e([i]);i=(p.then?(await p)():p)[0];let c=new n.AppRouteRouteModule({definition:{kind:a.RouteKind.APP_ROUTE,page:"/api/channels/route",pathname:"/api/channels",filename:"route",bundlePath:"app/api/channels/route"},resolvedPagePath:"/Users/rohan/code/realtalk/app/api/channels/route.ts",nextConfigOutput:"",userland:i}),{workAsyncStorage:l,workUnitAsyncStorage:d,serverHooks:h}=c;function u(){return(0,o.patchFetch)({workAsyncStorage:l,workUnitAsyncStorage:d})}s()}catch(e){s(e)}})},44443:(e,t,r)=>{r.a(e,async(e,s)=>{try{r.r(t),r.d(t,{GET:()=>p,POST:()=>u});var n=r(10949),a=r(13122),o=r(19246),i=e([a,o]);async function p(){try{let e=await (0,o.db)`SELECT * FROM channels ORDER BY is_system DESC, created_at DESC`;return n.NextResponse.json({channels:e})}catch(e){return n.NextResponse.json({error:e.message},{status:500})}}async function u(e){try{let t=await (0,a.HW)();if(!t)return n.NextResponse.json({error:"Unauthorized"},{status:401});if("qwea"!==t.signup_code)return n.NextResponse.json({error:"Only gold users can create channels"},{status:403});let{name:r}=await e.json();if(!r||"string"!=typeof r||r.trim().length<2)return n.NextResponse.json({error:"Channel name must be at least 2 characters"},{status:400});let s=r.trim().slice(0,50);if((await (0,o.db)`SELECT id FROM channels WHERE name = ${s} LIMIT 1`).length>0)return n.NextResponse.json({error:"Channel name already exists"},{status:400});let i=await (0,o.db)`
      INSERT INTO channels (name, creator_id, is_system)
      VALUES (${s}, ${t.id}, FALSE)
      RETURNING *
    `;return n.NextResponse.json({channel:i[0]})}catch(e){return n.NextResponse.json({error:e.message},{status:500})}}[a,o]=i.then?(await i)():i,s()}catch(e){s(e)}})},44870:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},55511:e=>{e.exports=require("crypto")},63033:e=>{e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[9369,5886,1854,2920,4418],()=>r(32898));module.exports=s})();